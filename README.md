# ğŸ§  Brain-Age Prediction Challenge
The challenge is to predict chronological age of cognitively healthy adults using Graph Neural Networks (GNNs), applied to FreeSurfer-derived Structural MRI features from OASIS-3 dataset.

* **Task:** Regression
* **Target:** `age_at_visit` (in years)
* **Primary Metric:** Mean Absolute Error (MAE)

---

## ğŸ“Š Dataset Description
The dataset is curated from the **OASIS-3** longitudinal cohort. To ensure a pure aging baseline, we selected individuals who remained cognitively normal at all available visits (no MCI or dementia diagnoses).

* **Cohort:** 288 subjects (431 total sessions).
* **Preprocessing:** MRI scans were processed via the [FreeSurfer Pipeline](https://surfer.nmr.mgh.harvard.edu/). Processed data were sourced from the [Neuroimaging Informatics Tools and Resources Clearinghouse (NITRC)](https://www.nitrc.org/projects/oasis3) repository. For simplicity, this challenge focuses exclusively on cortical measures (excluding subcortical and other regions). **Desikan-Killiany atlas** was used for cortical parcellation, which defines 68 cortical regions (34 per hemisphere).
* **Structural Features:** For each of the 68 cortical regions, two primary morphological metric is provided: **Cortical Thickness (mm)** and **Cortical Gray Matter Volume (mmÂ³)**.
* **Structural Connectomes:** Connectivity data (adjacency matrices) were sourced from [BrainGraph.org](https://braingraph.org/cms/), generated by the **PIT Bioinformatics Group**. The adjacency matrix for each 431 subject scans are provided. Steps to extract the adjacency matrix of each subject/sessions is described below.
---

## âš™ï¸ Graph Specifications
Each MRI session is represented as a graph:

* **Nodes ($N=68$):** Representing the 68 cortical regions.
* **Node Features:** A 2D vector per region:
    1.  **Cortical Thickness** (mm)
    2.  **Gray Matter Volume** (mmÂ³)
    * *Total Features:* 68 nodes $\times$ 2 metrics = 136 structural features per graph.
* **Edges:** Weighted by **dMRI Streamline Counts** (Fiber Counts) between regions. Adjacency matrices are provided for each session.
* **Target:** Scalar **Age at Visit** (in years)

---

## ğŸ“‚ Repository Structure

```
.
â””â”€â”€ .github/workflows/
|    â”œâ”€â”€ score_submission.yml
|    â”œâ”€â”€ update_leaderboard.yml
|
â”œâ”€â”€ competition/
â”‚   â”œâ”€â”€ config.yaml
â”‚   â”œâ”€â”€ evaluate.py
â”‚   â”œâ”€â”€ metrics.py
â”‚   â””â”€â”€ render_leaderboard.py
|   â””â”€â”€ validate_submission.py
|
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ adjacency_matrices
â”‚   â”‚   |    â””â”€â”€ OAS30001_d0757.csv
â”‚   â”‚   |    â””â”€â”€ OAS30001_d3132.csv
â”‚   â”‚   |    â””â”€â”€ ...
â”‚   â”‚   |
â”‚   â”‚   â””â”€â”€ train_data.csv
â”‚   â”‚   â””â”€â”€ val_data.csv
â”‚   â”‚   â””â”€â”€ test_data.csv
â”‚   â”‚
â”‚   â””â”€â”€ sample/
â”‚       â””â”€â”€ predictions.csv   
|
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ leaderboard.css
â”‚   â””â”€â”€ leaderboard.html
â”‚   â””â”€â”€ leaderboard.js
|
â”œâ”€â”€ submissions/
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ inbox/
â”‚
â”œâ”€â”€ leaderboard/
â”‚   â”œâ”€â”€ leaderboard.csv
â”‚   â””â”€â”€ leaderboard.md
â””â”€â”€ leaderboard.html
â””â”€â”€ README.md

```


The dataset (431 total sessions) is split approximately into **80% Training**, **10% Validation**, and **10% Testing**. The split was performed at the **subject level** (ensuring no subject appears in more than one set) and was **stratified by age** to ensure a balanced distribution across all subsets.

* **`data/public/train_data.csv`**: 
  Contains data for 230 patients (353 sessions). Each row represents one MRI session.
  * **Subject**: Unique identifier for the participant.
  * **MR_session**: Unique identifier for the specific scan session.
  * **age_at_visit**: The target variable (chronological age in years).
  * **136 Cortical Measures**: Volume and thickness metrics for the 68 cortical regions.

* **`data/public/val_data.csv`**: 
  Contains 29 patients (39 sessions) for validation. Follows the same structure as the training set.

* **`data/public/test_data.csv`**: 
  Contains 29 patients (39 sessions). The target column (`age_at_visit`) is omitted.

* **`data/public/adjacency_matrices/`**: 
  A directory containing the 68x68 structural connectivity matrices for every session in the dataset.

---

## ğŸ“¥ Loading the Adjacency Matrices
The adjacency matrices are provided as CSV files under `data/public/adjacency_matrices/`. Each file is named by its Session ID (e.g., `OAS30001_d0757.csv`). You can load them as follows:

```python
import pandas as pd

# Load a specific session's adjacency matrix
file_path = 'data/public/adjacency_matrices/OAS30001_d0757.csv'
adj_df = pd.read_csv(file_path, index_col=0)

# The matrix is 68x68, where rows/cols match the order of regions in train_data.csv
print(adj_df.shape)  # Output: (68, 68)

```
---

## ğŸ“ Submission Instructions

To participate in the challenge and get your score on the leaderboard, please follow these steps exactly:

### 1. Prepare Your Submission Files
You need to prepare two files:
* **`predictions.csv`**: Must contain exactly two columns: `subject_session` and `age_at_visit`. 
    * *Note:* The `subject_session` is the concatenation of the `Subject` and `MR_session` values from `test_data.csv` (e.g., `Test_Sub_001-Sess_01`).
* **`metadata.json`**: A file containing your team name, llm_name and any other relevant information.

**Sample Format for `predictions.csv`:**
| subject_session | age_at_visit |
| :--- | :--- |
| Test_Sub_001-Sess_01 | 66.03828 |
| Test_Sub_001-Sess_02 | 66.35320 |
| Test_Sub_002-Sess_01 | 63.15323 |

> ğŸ’¡ A template is provided at: `data/public/sample_submission.csv`

### 2. Submit via Pull Request
1.  **Fork** this repository.
2.  **Create a folder** named after your team under the `submissions/` directory: `submissions/<your_team_name>/`.
3.  **Upload** your `predictions.csv` and `metadata.json` into that folder.
4.  **Open a Pull Request (PR)** to the `main` branch of this repository.

### 3. Automated Scoring
* **Wait ~1-2 minutes.** Our automated bot will trigger as soon as you open the PR.
* The bot will calculate your **Mean Absolute Error (MAE)** and post it as a comment directly on your PR!
* Once your PR is merged, your results will be officially added to the leaderboard.

---

## ğŸ† Leaderboard

Evaluation is performed automatically using **Mean Absolute Error (MAE)**. After a PR is merged, the submission is archived in `leaderboard/leaderboard.csv` and updated in the project files.



ğŸ‘‰ **[View the Live Leaderboard Webpage Here](https://bjayadikary.github.io/brain-age-gnn-oasis3/leaderboard.html)**
